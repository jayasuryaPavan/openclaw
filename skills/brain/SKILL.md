---
name: brain
description: Panda Chat's self-learning neural network. Classifies intent, sentiment, and user preferences using a pure-Python feedforward network. No external ML dependencies. Learns from every interaction to get smarter over time.
---

# Brain

## Overview

The Brain is Panda Chat's self-learning core — a lightweight neural network that understands what you want, how you feel, and what you like. Unlike rule-based systems, it **learns and improves** from every conversation.

## Architecture

```
Input (50 vocab)
       ↓
   Dense (24 neurons, ReLU)
       ↓
   ┌───┼───┐
   ↓   ↓   ↓
Intent Sentiment Preference
 (8)    (3)      (5)
```

- **Intent**: GREETING, FAREWELL, REMINDER, SEARCH, HELP, WEATHER, EMAIL, GENERAL
- **Sentiment**: NEGATIVE, NEUTRAL, POSITIVE
- **Preference**: TECH, ENTERTAINMENT, PRODUCTIVITY, SOCIAL, LEARNING

## How It Learns

1. **Initial Training**: `scripts/train.py` trains on 50 labeled Tenglish/English samples
2. **Online Learning**: `scripts/predict.py --learn` teaches from individual messages
3. **Self-Improving**: Over time, accuracy increases as more interactions are recorded

## Usage

### Training
```bash
scripts/train.py                    # Train with default data
scripts/train.py --epochs 200       # More epochs = better accuracy
scripts/train.py --retrain          # Start fresh
```

### Prediction
```bash
scripts/predict.py "hello panda"                    # Quick prediction
scripts/predict.py "em undi bro" --verbose           # Full scores
echo "weather ela undi" | scripts/predict.py         # Piped input
```

### Online Learning
```bash
scripts/predict.py --learn "ey pandu" --intent GREETING --sentiment POSITIVE
```

## Integration with Other Skills

- **smart-cache**: If cache misses, use Brain to classify before sending to LLM
- **nlp-core**: Brain provides neural predictions; nlp-core provides rule-based analysis
- **audio-core**: Transcribed voice messages are fed to Brain for classification

## Resources

### scripts/
- `brain_core.py`: Pure-Python neural network engine (multi-head, SGD+momentum, online learning)
- `train.py`: Training pipeline with logging and quick-test
- `predict.py`: Prediction and online learning CLI

### references/
- `model_config.json`: Network architecture and label definitions
- `training_data.json`: 50 labeled training samples (Tenglish/English)

### data/
- `weights.json`: Trained model weights (auto-generated by train.py)
- `vocabulary.json`: Learned vocabulary (auto-generated)
- `training_log.json`: History of all training runs
